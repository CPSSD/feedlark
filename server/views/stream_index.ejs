<% include partials/header.ejs %>
    <div class="container">
      <div class="row">
        <div class="col s6 offset-s3">
          <h3 class="center-align">Your feeds</h3>
        </div>
      </div>

      <ul class="collection">
        <% if (typeof feeds == "undefined" || feeds.length < 1) { %>
        <li class="collection-item">
          <p class="center-align">Failed to load your feeds. No data was received from the server</p>
        </div>
        <%
        } else {
          for (var i = 0; i < feeds.length; i++) {
            var date = new Date(feeds[i].pub_date);
            date = date.toLocaleDateString();
            var url = feeds[i].feed.match(/https?:\/\/[^\/]+/g)[0];
            var source_name_re = /https?:\/\/([^\/]+)/g;
            var source_name = source_name_re.exec(feeds[i].feed)[1];
        %>
        <li class="collection-item avatar">
          <img src="<%= url %>/favicon.ico" alt="favicon" class="circle">
          <span class="title"><%= feeds[i].name %></span>
          <p>
            Published: <%= date %> <br />
            From: <%= source_name %>
          </p>
          <span class="secondary-content" style="text-align: right;">
          <a href="/feeds/dislike?url=<%= feeds[i].link %>"><i class="material-icons">thumb_down</i></a>
          <a href="/feeds/like?url=<%= feeds[i].link %>"><i class="material-icons">thumb_up</i></a>
          <br />
          <a href="<%= feeds[i].link%>"><i class="material-icons">send</i></a>
          </span>
        </li>

        <% } } %>
      </ul>
    </div>
<% include partials/footer.ejs %>
